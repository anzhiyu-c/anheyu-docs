---
title: 配置指南
description: 了解 Anheyu 的详细配置选项
---

## ip 信息获取

安和鱼系统中的 ip 地址来源于 青桔 API

系统默认配置了 API 地址以及 TOKEN，但是不保证可用性，你可以登录后台在

`系统设置` -> `文章配置` 里面配置 `IP 属地查询 API 地址` 以及 `IP属地查询 API Token`

可以到 [https://api.nsmao.net](https://api.nsmao.net) 注册账户并且获取 Token 后填写进来(强烈建议)

## 邮件配置

你可以登录后台在 `系统设置` -> `邮件配置` 里面配置 SMTP 相关配置

## 存储策略

在 `系统设置` -> `存储策略` 中配置文件存储方式。

### 支持的存储类型

| 存储策略   | 说明                 | 适用场景             |
| ---------- | -------------------- | -------------------- |
| 本机存储   | 存储在服务器本地     | 私有部署、小规模应用 |
| OneDrive   | 微软 OneDrive 云存储 | 大容量云存储         |
| 腾讯云 COS | 腾讯云对象存储       | 国内部署、CDN 加速   |
| 阿里云 OSS | 阿里云对象存储       | 国内部署、CDN 加速   |
| AWS S3     | 亚马逊 S3 及兼容服务 | 国际部署、S3 兼容    |

### 配置说明

**本机存储**：文件保存在 `data/storage/` 目录，存储路径 `/comments` 对应 `data/storage/comments/`

**OneDrive**：需在 [Azure 门户](https://portal.azure.com) 注册应用获取客户端 ID 和密钥，API 权限需包含 `Files.ReadWrite.All` 和 `offline_access`

**云存储（腾讯云 COS/阿里云 OSS/AWS S3）**：

- 推荐使用**客户端直传**方式，需配置 CORS 跨域规则
- 支持 CDN 加速和图片处理（样式分隔符）
- 按量计费

### 默认存储策略

系统内置两个默认策略，首次注册时自动创建：

- `article_image`：文章图片存储
- `comment_image`：评论图片存储

## 文件管理

系统存在两个默认文件夹，不支持删除。

`comment_image`: 评论图片
`article_image`: 文章图片

## 缩略图

系统支持为图片、视频、音频自动生成缩略图。

### 支持的文件类型

| 类型 | 格式                      | 说明         |
| ---- | ------------------------- | ------------ |
| 图片 | PNG、JPEG、GIF、WebP、BMP | 内置处理引擎 |
| 视频 | MP4、AVI、MOV、MKV、WebM  | 提取关键帧   |
| 音频 | MP3、MP4、M4A、FLAC、OGG  | 提取专辑封面 |

### 生成方式

- **按需生成**：查看文件时自动生成，不占用上传时间
- **手动生成**：右键文件选择"重新生成缩略图"
- **批量生成**：目录操作中选择"批量重新生成缩略图"

### 存储策略支持

| 存储策略   | 支持程度    | 说明                     |
| ---------- | ----------- | ------------------------ |
| 本机存储   | ✅ 完全支持 | 支持所有类型             |
| 腾讯云 COS | ✅ 完全支持 | 支持所有类型             |
| 阿里云 OSS | ✅ 完全支持 | 支持所有类型             |
| AWS S3     | ✅ 完全支持 | 支持所有类型             |
| OneDrive   | ⚠️ 有限支持 | 依赖 OneDrive 原生缩略图 |

<Callout type="info" title="提示">
  缩略图自动缓存，采用 LRU 算法管理。OneDrive 存储建议开启"缩略图代理生成"以获得完整支持。
</Callout>
